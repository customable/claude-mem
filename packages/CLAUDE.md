<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #272 | 12:01 PM | ğŸ”µ | Prometheus metrics implementation | ~2166 |
| #270 | 12:01 PM | ğŸŸ  | Added Package Structure Documentation | ~4272 |
| #264 | 12:01 PM | ğŸ”µ | Reviewed development activity log | ~2215 |
| #262 | 12:00 PM | ğŸ”µ | Environment variables in hooks package | ~1761 |
| #260 | 12:00 PM | ğŸ”µ | Subagent event tracking | ~1205 |
| #259 | 12:00 PM | ğŸ”µ | Subagent functionality across files | ~1029 |
| #255 | 12:00 PM | ğŸ”µ | Task system architecture | ~2977 |
| #253 | 12:00 PM | ğŸ”µ | Worker lifecycle patterns | ~1957 |
| #250 | 12:00 PM | ğŸ”µ | MCP Server Implementation | ~3023 |
| #248 | 12:00 PM | ğŸ”µ | Hook Runner Architecture | ~2148 |
| #247 | 12:00 PM | ğŸ”µ | Subagent Stop Hook Handler | ~1265 |
| #246 | 12:00 PM | ğŸ”µ | Plugin entry point architecture | ~3044 |
| #245 | 12:00 PM | ğŸ”µ | Subagent Start Hook Handler | ~1328 |
| #244 | 12:00 PM | ğŸ”µ | Post-tool-use handler | ~2609 |
| #241 | 12:00 PM | ğŸ”µ | Hooks Router Implementation | ~3455 |
| #240 | 12:00 PM | ğŸ”µ | Hook handlers registry | ~1479 |
| #239 | 12:00 PM | ğŸ”µ | Session Start Handler | ~3290 |
| #233 | 12:00 PM | ğŸ”µ | User prompt submission handler | ~2003 |
| #231 | 12:00 PM | ğŸ”µ | Hook system types | ~1604 |
| #220 | 11:58 AM | ğŸ”µ | Observation type configuration | ~2243 |
| #218 | 11:58 AM | ğŸ”µ | Task Service backpressure | ~1543 |
| #217 | 11:58 AM | ğŸ”µ | Observation Entity Structure | ~1635 |
| #210 | 11:57 AM | ğŸŸ  | Auto-Spawn Status Indicator | ~5481 |
| #209 | 11:57 AM | ğŸ”µ | MemoriesView component | ~1593 |
| #208 | 11:57 AM | ğŸŸ  | Auto-spawn fields added | ~5578 |
| #206 | 11:57 AM | ğŸ”µ | WorkerStatus component | ~5211 |
| #205 | 11:57 AM | ğŸ”µ | App.tsx routing | ~2114 |
| #203 | 11:57 AM | ğŸ”µ | SpawnStatus interface | ~888 |
| #202 | 11:57 AM | ğŸ”µ | Dashboard SSE updates | ~1658 |
| #201 | 11:57 AM | ğŸ”µ | TaskRepository JSON handling | ~1639 |

## Key Insights

- **Comprehensive Monitoring**: Prometheus metrics implementation tracks HTTP requests, task processing, worker utilization, and database operations (~#272).
- **Documentation Enhancement**: Added detailed package structure documentation with dependency graphs and import rules (~#270).
- **Task System Architecture**: Backend creates tasks and assigns them to workers based on capabilities, with various task types like observation and summarization (~#255).
- **Worker Lifecycle**: Extensive use of `process.exit()` across multiple files for worker lifecycle management (~#253).
- **UI Improvements**: Added auto-spawn status indicators and fields to WorkerStatus component (~#210, ~#208).
</claude-mem-context>

# Package Structure

## Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  types   â”‚  â† Pure TypeScript interfaces, no runtime code
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  shared  â”‚  â† Runtime utilities: logger, settings, paths
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ database â”‚     â”‚  worker  â”‚     â”‚  hooks   â”‚
â”‚          â”‚     â”‚          â”‚â—„â”€â”€â”€â”€â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ backend  â”‚     â”‚    ui    â”‚  â† Communicates via HTTP API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Package Overview

| Package | Purpose | Key Exports |
|---------|---------|-------------|
| **types** | TypeScript definitions | Interfaces, types, enums (no runtime) |
| **shared** | Runtime utilities | `createLogger`, `loadSettings`, `PATHS` |
| **database** | Data persistence | MikroORM entities, repositories |
| **backend** | API server | Express routes, services, WebSocket |
| **hooks** | Claude integration | Hook handlers for Claude Code events |
| **worker** | AI processing | Observation extraction, summarization |
| **ui** | Web interface | React/Vite frontend |

## Guidelines

### Where to put new code?

- **New interface/type?** â†’ `types`
- **Utility function used by multiple packages?** â†’ `shared`
- **Database entity or query?** â†’ `database`
- **API endpoint?** â†’ `backend`
- **Claude hook handler?** â†’ `hooks`
- **AI task processing?** â†’ `worker`
- **UI component?** â†’ `ui`

### Import Rules

1. `types` has no internal dependencies
2. `shared` only imports from `types`
3. `database` imports from `shared` and `types`
4. `backend` can import from all except `hooks` and `ui`
5. `ui` has no internal dependencies (HTTP API only)