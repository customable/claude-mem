<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #3464 | 8:49 PM | ğŸŸ  | Created Workers View with Tabbed Interface | ~2221 |
| #3451 | 8:45 PM | ğŸ”µ | SSE Broadcaster Service Structure | ~1670 |
| #3449 | 8:45 PM | ğŸ”µ | API Client Structure and Types | ~1814 |
| #3440 | 8:44 PM | ğŸ”µ | SSE Event Type Definition and Usage | ~2338 |
| #3438 | 8:43 PM | ğŸ”µ | Discovered files containing HUB_TOKEN or Settings interface | ~1267 |
| #3433 | 8:43 PM | ğŸ”µ | Exploring Endless Mode and Default Settings Configuration | ~2383 |
| #3428 | 8:42 PM | ğŸŸ  | Added HubFederation exports to WebSocket module | ~2220 |
| #3426 | 8:41 PM | ğŸŸ  | Created worker-hub package index file | ~1400 |
| #3423 | 8:41 PM | ğŸŸ  | Create Worker Hub CLI for distributed deployments | ~2907 |
| #3417 | 8:39 PM | ğŸ”µ | Worker package configuration and dependencies | ~1615 |
| #3415 | 8:39 PM | âš™ï¸ | Created TypeScript configuration for worker-hub package | ~1304 |
| #3414 | 8:38 PM | ğŸŸ  | Add FederatedRouter and TaskRoutingOptions exports to WebSocket module | ~1972 |
| #3413 | 8:38 PM | ğŸŸ  | Created worker-hub package.json with CLI and WebSocket dependencies | ~1946 |
| #3407 | 8:37 PM | ğŸ”µ | WebSocket module exports structure discovered | ~1314 |
| #3393 | 8:32 PM | ğŸ”µ | MikroORM migration configuration structure discovered | ~2002 |
| #3392 | 8:32 PM | ğŸ“¦ | Add new migration for worker federation | ~2377 |
| #3391 | 8:31 PM | ğŸ”µ | Worker-related migration files discovered | ~1436 |
| #3390 | 8:31 PM | ğŸ”µ | MikroORM migration files structure discovered | ~1295 |
| #3385 | 8:30 PM | ğŸ”µ | Hub registry service methods for filtering hubs | ~1674 |
| #3377 | 8:30 PM | ğŸ”µ | Worker token service methods for heartbeat and registration | ~1744 |
| #3371 | 8:28 PM | ğŸ”µ | Worker Token Service Implementation Details | ~2206 |
| #3357 | 8:26 PM | ğŸŸ  | Add SqlEntityManager type re-export for service usage | ~1913 |
| #3356 | 8:26 PM | ğŸ”µ | EntityManager usage in backend services | ~1309 |
| #3355 | 8:26 PM | ğŸ”µ | Database module import found in backend service | ~1105 |
| #3354 | 8:26 PM | ğŸ”µ | No Mikro-ORM dependency found in backend package.json | ~1087 |
| #3353 | 8:26 PM | ğŸ”µ | MikroORM database layer exports structure | ~1419 |
| #3351 | 8:25 PM | ğŸ”µ | MikroORM Database Initializer Structure | ~1943 |
| #3349 | 8:25 PM | ğŸ“ | Database layer documentation and structure overview | ~1396 |
| #3348 | 8:25 PM | ğŸ”µ | Database entities structure discovered | ~1574 |
| #3346 | 8:25 PM | ğŸ”µ | Exploring shared TypeScript types in claude-mem system | ~1544 |

## Key Insights

- **Worker Federation Architecture**: Significant progress on distributed worker hubs with new CLI tools, WebSocket integrations, and database migrations for worker federation (Issues #263, #109).
- **Real-time UI Updates**: SSE Broadcaster service now manages Server-Sent Events for real-time UI updates, with defined event types for system notifications.
- **Database Evolution**: MikroORM migrations added for worker federation, revealing a structured approach to schema changes with explicit migration lists.
- **Type Safety Improvements**: Added SqlEntityManager type exports and discovered EntityManager usage patterns in backend services.
- **Integration Points**: Identified multiple integration opportunities (Crush hooks, OpenCode libraries) and documented missing hooks (SessionEnd, Stop, Notification) for future implementation.
</claude-mem-context>

# Package Structure

## Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  types   â”‚  â† Pure TypeScript interfaces, no runtime code
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  shared  â”‚  â† Runtime utilities: logger, settings, paths
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ database â”‚     â”‚  worker  â”‚     â”‚  hooks   â”‚
â”‚          â”‚     â”‚          â”‚â—„â”€â”€â”€â”€â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ backend  â”‚     â”‚    ui    â”‚  â† Communicates via HTTP API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Package Overview

| Package | Purpose | Key Exports |
|---------|---------|-------------|
| **types** | TypeScript definitions | Interfaces, types, enums (no runtime) |
| **shared** | Runtime utilities | `createLogger`, `loadSettings`, `PATHS` |
| **database** | Data persistence | MikroORM entities, repositories |
| **backend** | API server | Express routes, services, WebSocket |
| **hooks** | Claude integration | Hook handlers for Claude Code events |
| **worker** | AI processing | Observation extraction, summarization |
| **ui** | Web interface | React/Vite frontend |

## Guidelines

### Where to put new code?

- **New interface/type?** â†’ `types`
- **Utility function used by multiple packages?** â†’ `shared`
- **Database entity or query?** â†’ `database`
- **API endpoint?** â†’ `backend`
- **Claude hook handler?** â†’ `hooks`
- **AI task processing?** â†’ `worker`
- **UI component?** â†’ `ui`

### Import Rules

1. `types` has no internal dependencies
2. `shared` only imports from `types`
3. `database` imports from `shared` and `types`
4. `backend` can import from all except `hooks` and `ui`
5. `ui` has no internal dependencies (HTTP API only)