<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2570 | 6:42 PM | ğŸ”µ | Found broadcastClaudeMdReady method in SSE broadcaster | ~2155 |
| #2567 | 6:42 PM | ğŸ”µ | Discovered files related to ClaudeMd task processing | ~1234 |
| #2566 | 6:42 PM | ğŸ”µ | Working directory handling in task dispatcher | ~1466 |
| #2563 | 6:41 PM | ğŸ”µ | Identifying files related to ClaudeMD state and directory handling | ~1342 |
| #2560 | 6:41 PM | ğŸ”µ | Identified files containing targetDirectory or claudemd:ready patterns | ~767 |
| #2537 | 6:36 PM | ğŸ”µ | ExportRouter initialization in backend service | ~1334 |
| #2534 | 6:35 PM | ğŸ”µ | User Tasks View Component Structure | ~2333 |
| #2529 | 6:34 PM | ğŸ”µ | Discovered user-task event types in SSE broadcaster and hooks | ~1294 |
| #2526 | 6:34 PM | ğŸ”µ | SSE usage found in UI package | ~1410 |
| #2510 | 6:29 PM | ğŸ”µ | Backend service routes and dependencies discovered | ~1293 |
| #2509 | 6:29 PM | ğŸ”µ | DataRouter instantiation found in backend-service.ts | ~754 |
| #2502 | 6:28 PM | ğŸ”µ | User Task Type System Structure | ~2197 |
| #2501 | 6:28 PM | ğŸ”µ | Sidebar Component Structure and Navigation Logic | ~1887 |
| #2473 | 6:22 PM | ğŸ”µ | API Rate Limiting and Router Structure | ~1805 |
| #2472 | 6:22 PM | ğŸ”µ | HooksRouter usage found in backend-service.ts | ~1107 |
| #2462 | 6:20 PM | ğŸ”µ | Hook handlers registry structure discovered | ~1475 |
| #2458 | 6:20 PM | ğŸ”µ | Hook system types and structure discovered | ~1933 |
| #2449 | 6:17 PM | ğŸŸ  | Add user_tasks table migration for CLI task tracking | ~2548 |
| #2446 | 6:17 PM | ğŸ”µ | Migration for archived_outputs table discovered | ~1932 |
| #2442 | 6:17 PM | ğŸŸ  | Add MikroOrmUserTaskRepository export to repositories index | ~1722 |
| #2441 | 6:17 PM | ğŸŸ  | Add user task types export to types index | ~1573 |
| #2439 | 6:17 PM | ğŸ”µ | MikroORM Database Initializer Structure | ~1931 |
| #2438 | 6:17 PM | ğŸ”µ | Discovered MikroORM repository exports structure | ~1594 |
| #2434 | 6:16 PM | ğŸ”µ | Found Mikro-ORM initializer files in database package | ~1168 |
| #2432 | 6:16 PM | ğŸ”µ | Exploring shared TypeScript types in claude-mem | ~1425 |
| #2431 | 6:15 PM | ğŸŸ  | Added User Task Types and Repository Interface | ~3097 |
| #2427 | 6:14 PM | ğŸ”µ | Exploring Observation Entity Structure | ~1819 |
| #2426 | 6:14 PM | ğŸ”µ | Database configuration and migration structure discovered | ~1596 |
| #2425 | 6:14 PM | ğŸ“ | Reviewed MikroORM configuration file header | ~1371 |
| #2424 | 6:14 PM | ğŸ”µ | Discovered MikroORM entity configuration | ~1773 |

## Key Insights

- **Event-Driven Architecture**: The system heavily relies on SSE (Server-Sent Events) for real-time updates, with a robust hook system for event handling (e.g., `user-task:created`, `user-task:updated`).
- **Task Management**: A new `user_tasks` table and related infrastructure were added to track CLI tool tasks, including status lifecycle, priority, and cost tracking.
- **Database Structure**: MikroORM is used for database operations, supporting SQLite, PostgreSQL, and MySQL, with a well-defined entity and repository structure.
- **Component Discovery**: Key components like `UserTasks.tsx`, `Sidebar`, and `ExportRouter` were explored, revealing the UI and backend service architecture.
- **Performance Metrics**: High token compression efficiency (94.5%) was noted, alongside potential optimizations for search results and task queue handling.
</claude-mem-context>

# Package Structure

## Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  types   â”‚  â† Pure TypeScript interfaces, no runtime code
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  shared  â”‚  â† Runtime utilities: logger, settings, paths
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ database â”‚     â”‚  worker  â”‚     â”‚  hooks   â”‚
â”‚          â”‚     â”‚          â”‚â—„â”€â”€â”€â”€â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ backend  â”‚     â”‚    ui    â”‚  â† Communicates via HTTP API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Package Overview

| Package | Purpose | Key Exports |
|---------|---------|-------------|
| **types** | TypeScript definitions | Interfaces, types, enums (no runtime) |
| **shared** | Runtime utilities | `createLogger`, `loadSettings`, `PATHS` |
| **database** | Data persistence | MikroORM entities, repositories |
| **backend** | API server | Express routes, services, WebSocket |
| **hooks** | Claude integration | Hook handlers for Claude Code events |
| **worker** | AI processing | Observation extraction, summarization |
| **ui** | Web interface | React/Vite frontend |

## Guidelines

### Where to put new code?

- **New interface/type?** â†’ `types`
- **Utility function used by multiple packages?** â†’ `shared`
- **Database entity or query?** â†’ `database`
- **API endpoint?** â†’ `backend`
- **Claude hook handler?** â†’ `hooks`
- **AI task processing?** â†’ `worker`
- **UI component?** â†’ `ui`

### Import Rules

1. `types` has no internal dependencies
2. `shared` only imports from `types`
3. `database` imports from `shared` and `types`
4. `backend` can import from all except `hooks` and `ui`
5. `ui` has no internal dependencies (HTTP API only)