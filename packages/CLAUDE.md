<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 24

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #14413 | 10:17 PM | ğŸ”µ | Hook Handlers Registry Structure | ~1364 |
| #14412 | 10:16 PM | ğŸ”µ | Privacy handling in share-service.ts | ~1231 |
| #14409 | 10:15 PM | ğŸ”´ | Fix null handling in processSessionForSharing | ~5228 |
| #14406 | 10:15 PM | ğŸ”´ | Fix null handling in processObservationForSharing | ~5486 |
| #14405 | 10:15 PM | ğŸ”´ | Filter out null/undefined session IDs in fetchSessions | ~5141 |
| #14403 | 10:15 PM | ğŸ”µ | Privacy handling in share-service.ts | ~1735 |
| #14402 | 10:15 PM | ğŸ”µ | Discovered pinned field in database schema | ~824 |
| #14401 | 10:15 PM | ğŸ”µ | Exploring SdkSessionRecord interface and its usage | ~4715 |
| #14400 | 10:15 PM | ğŸ”µ | SDKSessionRecord type usage in share-service.ts | ~766 |
| #14398 | 10:14 PM | ğŸ”„ | Rename SDKSessionRecord to SdkSessionRecord | ~4879 |
| #14397 | 10:14 PM | ğŸŸ  | Added ShareService to BackendService class | ~4908 |
| #14396 | 10:14 PM | ğŸ”„ | Rename SDKSessionRecord to SdkSessionRecord for consistency | ~2959 |
| #14394 | 10:14 PM | ğŸŸ  | Added ShareRouter to backend service | ~5080 |
| #14393 | 10:14 PM | ğŸŸ  | Adding ShareService to backend-service imports | ~5031 |
| #14392 | 10:13 PM | ğŸ”µ | Backend service routes and static UI serving | ~1336 |
| #14391 | 10:13 PM | ğŸŸ  | Added ShareService initialization to BackendService | ~5129 |
| #14390 | 10:13 PM | ğŸ”µ | Backend service initialization and route registration | ~1771 |
| #14389 | 10:13 PM | ğŸŸ  | Added ShareRouter import to backend service | ~4879 |
| #14388 | 10:13 PM | ğŸ”µ | Backend Service Architecture Overview | ~1916 |
| #14387 | 10:13 PM | ğŸŸ  | Added ShareRouter exports to routes index | ~1515 |
| #14386 | 10:13 PM | ğŸŸ  | Added ShareService exports to services index | ~1369 |
| #14384 | 10:13 PM | ğŸŸ  | Implemented ShareRouter for memory sharing API | ~5475 |
| #14381 | 10:12 PM | ğŸŸ  | Created Share Service for memory sharing functionality | ~6893 |
| #14379 | 10:12 PM | ğŸ”µ | No references to subagent-related terms found in TypeScript files | ~733 |
| #14376 | 10:11 PM | ğŸ”µ | Session Service Structure and User Prompt Handling | ~2247 |
| #14375 | 10:11 PM | ğŸ”µ | Hook system types and structure discovered | ~1521 |
| #14374 | 10:11 PM | ğŸ”µ | Backend Client Implementation Analysis | ~2089 |
| #14372 | 10:11 PM | ğŸ”µ | Exploring shared TypeScript types structure | ~1077 |
| #14371 | 10:11 PM | ğŸŸ  | Added memory sharing types export to main types index | ~1091 |
| #14369 | 10:11 PM | ğŸŸ  | Added memory sharing types and interfaces | ~4751 |

## Key Insights

- **Memory Sharing Feature Added**: A comprehensive memory sharing system was implemented with ShareService, ShareRouter, and related types, enabling collaboration features with privacy controls.
- **Null Safety Improvements**: Multiple bug fixes addressed null handling in session processing and observation sharing, improving runtime stability.
- **Naming Consistency**: Refactored `SDKSessionRecord` to `SdkSessionRecord` for consistent PascalCase naming throughout the codebase.
- **Subagent Absence Confirmed**: No subagent functionality exists in the codebase despite database fields suggesting potential support.
- **Backend Architecture**: The backend service orchestrates multiple components (sessions, hooks, sharing) with modular route handling and database support.
</claude-mem-context>

# Package Structure

## Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  types   â”‚  â† Pure TypeScript interfaces, no runtime code
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  shared  â”‚  â† Runtime utilities: logger, settings, paths
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ database â”‚     â”‚  worker  â”‚     â”‚  hooks   â”‚
â”‚          â”‚     â”‚          â”‚â—„â”€â”€â”€â”€â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ backend  â”‚     â”‚    ui    â”‚  â† Communicates via HTTP API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Package Overview

| Package | Purpose | Key Exports |
|---------|---------|-------------|
| **types** | TypeScript definitions | Interfaces, types, enums (no runtime) |
| **shared** | Runtime utilities | `createLogger`, `loadSettings`, `PATHS` |
| **database** | Data persistence | MikroORM entities, repositories |
| **backend** | API server | Express routes, services, WebSocket |
| **hooks** | Claude integration | Hook handlers for Claude Code events |
| **worker** | AI processing | Observation extraction, summarization |
| **ui** | Web interface | React/Vite frontend |

## Guidelines

### Where to put new code?

- **New interface/type?** â†’ `types`
- **Utility function used by multiple packages?** â†’ `shared`
- **Database entity or query?** â†’ `database`
- **API endpoint?** â†’ `backend`
- **Claude hook handler?** â†’ `hooks`
- **AI task processing?** â†’ `worker`
- **UI component?** â†’ `ui`

### Import Rules

1. `types` has no internal dependencies
2. `shared` only imports from `types`
3. `database` imports from `shared` and `types`
4. `backend` can import from all except `hooks` and `ui`
5. `ui` has no internal dependencies (HTTP API only)