<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2806 | 7:15 PM | ğŸ”µ | Worker task assignment mechanism discovered | ~1484 |
| #2804 | 7:15 PM | ğŸ”µ | WorkerHub class methods for worker management | ~1974 |
| #2785 | 7:10 PM | ğŸ”µ | Worker message handling architecture discovered | ~1532 |
| #2781 | 7:09 PM | ğŸ”µ | WebSocket Server Implementation with Heartbeat | ~1979 |
| #2775 | 7:09 PM | ğŸ”µ | Worker Hub WebSocket Management Structure | ~1803 |
| #2774 | 7:08 PM | ğŸŸ  | Created SSE-Writer Client Type for WebSocket | ~2887 |
| #2772 | 7:08 PM | ğŸŸ  | Added channel types export for unified WebSocket | ~1687 |
| #2767 | 7:08 PM | ğŸŸ  | Added ChannelManager export to WebSocket module | ~1723 |
| #2766 | 7:08 PM | ğŸ”µ | WebSocket module exports identified | ~1163 |
| #2764 | 7:08 PM | ğŸ”µ | Exploring shared TypeScript types in claude-mem | ~1469 |
| #2746 | 7:02 PM | ğŸ”µ | WebSocket Protocol Types for Worker-Backend Comm | ~2206 |
| #2742 | 7:01 PM | ğŸ”µ | Exploring shared TypeScript types in claude-mem | ~1437 |
| #2738 | 7:01 PM | ğŸ”µ | WebSocket Protocol Types for Backend-Worker Comm | ~2228 |
| #2736 | 7:00 PM | ğŸ”µ | WebSocket Types Structure | ~1453 |
| #2732 | 7:00 PM | ğŸ”µ | SSE broadcast mechanism usage across backend | ~1863 |
| #2731 | 7:00 PM | ğŸ”µ | Backend Service CLI Structure and Commands | ~2029 |
| #2729 | 7:00 PM | ğŸ”µ | SSE Stream Router Implementation | ~1584 |
| #2728 | 7:00 PM | ğŸ“ | WebSocket module exports overview | ~1177 |
| #2727 | 7:00 PM | ğŸ”µ | Event types used in SSE and WebSocket communication | ~1806 |
| #2722 | 6:59 PM | ğŸ”µ | SSE Broadcaster Service Implementation | ~2299 |
| #2719 | 6:59 PM | ğŸ”µ | No WebSocket route or subscription patterns found | ~1162 |
| #2718 | 6:59 PM | ğŸ”µ | SSE broadcasting methods for task and worker events | ~2232 |
| #2714 | 6:59 PM | ğŸ”µ | SSE broadcasting in task dispatcher | ~1448 |
| #2713 | 6:58 PM | ğŸ”µ | Live View Component Uses Server-Sent Events | ~1907 |
| #2712 | 6:58 PM | ğŸ“ | WorkerStatus component documentation | ~1998 |
| #2711 | 6:58 PM | ğŸ”µ | Search for SSE-related code in UI package | ~1076 |
| #2709 | 6:58 PM | ğŸ”µ | DashboardView component structure and SSE integration | ~2024 |
| #2706 | 6:58 PM | ğŸ”µ | SSE Stream Implementation Analysis | ~1568 |
| #2704 | 6:58 PM | ğŸ”µ | Backend Service CLI Structure and Commands | ~1982 |
| #2700 | 6:58 PM | ğŸ”µ | Search for SSE broadcaster usage in task dispatcher | ~1116 |

## Key Insights

- **WebSocket Architecture**: The system uses a robust WebSocket-based worker management system with `WorkerHub` for connection handling, task assignment, and heartbeat monitoring.
- **SSE Integration**: Server-Sent Events (SSE) are extensively used for real-time UI updates, including task lifecycle events and worker status tracking.
- **TypeScript Types**: Shared TypeScript types define WebSocket protocols, worker capabilities, and task definitions, ensuring type safety across the system.
- **Backend CLI**: The backend service supports CLI commands (`start`, `stop`, `status`) and uses SSE for real-time communication.
- **Recent Features**: New exports (`ChannelManager`, channel types) and client types (`SSE-Writer`) were added to enhance WebSocket functionality.

## Next Steps
- Implement configurable modes and git hooks for team collaboration.
- Address API authentication failures and SQLite lock contention issues.
- Optimize token usage and explore alternative domain naming strategies.
</claude-mem-context>

# Package Structure

## Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  types   â”‚  â† Pure TypeScript interfaces, no runtime code
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  shared  â”‚  â† Runtime utilities: logger, settings, paths
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ database â”‚     â”‚  worker  â”‚     â”‚  hooks   â”‚
â”‚          â”‚     â”‚          â”‚â—„â”€â”€â”€â”€â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ backend  â”‚     â”‚    ui    â”‚  â† Communicates via HTTP API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Package Overview

| Package | Purpose | Key Exports |
|---------|---------|-------------|
| **types** | TypeScript definitions | Interfaces, types, enums (no runtime) |
| **shared** | Runtime utilities | `createLogger`, `loadSettings`, `PATHS` |
| **database** | Data persistence | MikroORM entities, repositories |
| **backend** | API server | Express routes, services, WebSocket |
| **hooks** | Claude integration | Hook handlers for Claude Code events |
| **worker** | AI processing | Observation extraction, summarization |
| **ui** | Web interface | React/Vite frontend |

## Guidelines

### Where to put new code?

- **New interface/type?** â†’ `types`
- **Utility function used by multiple packages?** â†’ `shared`
- **Database entity or query?** â†’ `database`
- **API endpoint?** â†’ `backend`
- **Claude hook handler?** â†’ `hooks`
- **AI task processing?** â†’ `worker`
- **UI component?** â†’ `ui`

### Import Rules

1. `types` has no internal dependencies
2. `shared` only imports from `types`
3. `database` imports from `shared` and `types`
4. `backend` can import from all except `hooks` and `ui`
5. `ui` has no internal dependencies (HTTP API only)