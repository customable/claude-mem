# Claude-Mem Development Instructions

**WICHTIG: Alle Anweisungen in dieser Datei sind verbindlich und mÃ¼ssen strikt befolgt werden!**

## Workflow

### Commits & Push

- **Pro Issue mindestens ein Commit** (gerne auch mehr bei grÃ¶ÃŸeren Ã„nderungen)
- **Pushen nur mit Freigabe vom User**, auÃŸer der Prompt am Anfang erlaubt direktes Pushen
- Bei mehreren Issues: Pro Issue eigene Commits erstellen, dann am Ende gesammelt pushen (nach Freigabe)

### Issues umsetzen

- **Issues IMMER komplett umsetzen** - nicht in Phasen oder Teilschritten
- Erst mit dem nÃ¤chsten Issue beginnen, wenn das aktuelle vollstÃ¤ndig abgeschlossen ist
- Bei Blockern oder Unklarheiten: User fragen, nicht teilweise implementieren

### CLAUDE.md Dateien

- **Automatisch generierte CLAUDE.md-Dateien regelmÃ¤ÃŸig mit committen**
- Diese Dateien werden vom Plugin automatisch aktualisiert
- User-Content auÃŸerhalb der generierten Bereiche bleibt erhalten

## Technische Details

### Monorepo-Struktur

```
packages/
â”œâ”€â”€ backend/     # Express API Server
â”œâ”€â”€ database/    # MikroORM Entities & Repositories
â”œâ”€â”€ hooks/       # Claude Code Hook Handlers
â”œâ”€â”€ shared/      # Shared Utilities (Logger, Settings)
â”œâ”€â”€ types/       # TypeScript Interfaces
â”œâ”€â”€ ui/          # React/Vite Frontend
â””â”€â”€ worker/      # AI Task Processing
plugin/          # Claude Code Plugin
```

### Wichtige Befehle

```bash
# Development
pnpm dev              # Build plugin + sync to marketplace
pnpm build            # Build all packages
pnpm test             # Run tests
pnpm typecheck        # TypeScript check (1x ausfÃ¼hren bis "Done", bei unklarer Ausgabe Script anpassen)
pnpm sync-marketplace # Sync plugin to Claude marketplace
pnpm dev:restart      # Restart dev services

# Einzelne Packages builden
pnpm build:backend    # Backend only
pnpm build:worker     # Worker only
pnpm build:hooks      # Hooks only
pnpm build:plugin     # Plugin only

# Docker
pnpm docker:up        # Start containers
pnpm docker:down      # Stop containers
pnpm docker:logs      # View logs
```

### Issue-Tracker

- Repository: `customable/claude-mem` auf Forgejo
- Labels werden automatisch gesetzt (priority, type)
- **Kommentare und Attachments in Issues IMMER prÃ¼fen** - kÃ¶nnen wichtige Informationen enthalten
- **Blocks und Dependencies beachten** - Issues kÃ¶nnen andere blockieren oder von anderen abhÃ¤ngen

### UI-Referenzen

- Screenshots und Design-Referenzen: `~/references`

### Bei grÃ¶ÃŸeren Ã„nderungen

Nach Ã„nderungen an Backend, Worker oder Hooks:

1. **Plugin builden und syncen:**
   ```bash
   pnpm build && pnpm sync-marketplace
   ```

2. **Backend-Erreichbarkeit prÃ¼fen:**
   - Nach Neustart testen ob Backend erreichbar ist
   - Falls nicht erreichbar: Erst stoppen, dann **ohne** `-head` oder `-tail` neustarten
   - Direkt die JS-Datei ausfÃ¼hren um vollstÃ¤ndigen Log zu sehen:
     ```bash
     node packages/backend/dist/cli.js start
     ```

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2199 | 5:45 PM | ğŸ”µ | Open issues in claude-mem repository | ~1560 |
| #2198 | 5:45 PM | ğŸ”µ | No blocking issues found for issue #260 | ~1007 |
| #2197 | 5:45 PM | ğŸ”µ | Open issues in claude-mem repository | ~1571 |
| #2196 | 5:45 PM | ğŸ”µ | [Compressed] mcp__forgejo__get_issue | ~236 |
| #2195 | 5:44 PM | ğŸŸ£ | Commit auto-generated CLAUDE.md updates | ~1391 |
| #2194 | 5:41 PM | ğŸŸ£ | Completed database schema changes | ~1196 |
| #2193 | 5:40 PM | ğŸ”„ | Removed issue dependency #262 from #267 | ~750 |
| #2192 | 5:40 PM | ğŸŸ  | Added composite indexes to RawMessage | ~1850 |
| #2191 | 5:40 PM | ğŸ”„ | Add composite indexes for query patterns | ~1047 |
| #2190 | 5:39 PM | ğŸ”µ | Issue #267 blocked by database discussion | ~1169 |
| #2189 | 5:38 PM | ğŸ”µ | TypeScript type check passes | ~1036 |
| #2188 | 5:38 PM | ğŸ”„ | Add cascade options to database entities | ~1036 |
| #2187 | 5:38 PM | ğŸ”µ | TypeScript type check passes | ~1060 |
| #2186 | 5:38 PM | ğŸ”„ | Improved index documentation | ~1813 |
| #2185 | 5:38 PM | ğŸŸ  | Added composite index for session queries | ~1517 |
| #2184 | 5:37 PM | ğŸ”„ | Removed redundant entity-level indexes | ~1863 |
| #2183 | 5:37 PM | ğŸ”µ | Database entities use extensive indexing | ~5695 |
| #2182 | 5:37 PM | ğŸ”„ | Enhanced Session entity relations | ~2807 |
| #2181 | 5:36 PM | ğŸŸ  | Add Cascade import to Session entity | ~1724 |
| #2180 | 5:36 PM | ğŸ”µ | Build process completed with warnings | ~1172 |
| #2179 | 5:36 PM | ğŸ”„ | Add cascade options to Observation | ~3759 |
| #2178 | 5:36 PM | ğŸ”µ | Observation Entity Structure Analysis | ~2137 |
| #2177 | 5:36 PM | ğŸ”„ | Add Session as hub with entity relations | ~1083 |
| #2176 | 5:36 PM | ğŸŸ  | Add Cascade import to Observation | ~2237 |
| #2175 | 5:35 PM | ğŸ”„ | Refactor RawMessage observation relation | ~2098 |
| #2174 | 5:35 PM | ğŸ”„ | Refactor UserPrompt entity | ~2469 |
| #2173 | 5:35 PM | ğŸ”„ | Separate FK column in Summary entity | ~2065 |
| #2172 | 5:35 PM | ğŸ”µ | TypeScript type check passes | ~1012 |
| #2171 | 5:34 PM | ğŸ”„ | Refactor RawMessage entity | ~2251 |
| #2170 | 5:34 PM | ğŸ”„ | Refactor ClaudeMd entity | ~2622 |

## Key Insights

- **Database Optimization**: Extensive refactoring of database entities (e.g., Session, Observation, RawMessage) to improve query performance via composite indexes and cascade operations.
- **Type Safety**: All TypeScript checks pass across the monorepo, ensuring type safety and no regressions.
- **Issue Management**: Issue #267 (database schema changes) is no longer blocked by #262 (database discussion), allowing independent progress.
- **Build Warnings**: UI package has chunk size warnings (>500 kB), indicating potential optimization needs.
- **Endless Mode**: Recent work includes UI improvements (dashboard widgets, settings) and API endpoints for archived outputs, but latency issues (110s per tool use) remain unresolved.
</claude-mem-context>
