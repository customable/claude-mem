# Claude-Mem Development Instructions

**WICHTIG: Alle Anweisungen in dieser Datei sind verbindlich und mÃ¼ssen strikt befolgt werden!**

## Workflow

### Commits & Push

- **Pro Issue mindestens ein Commit** (gerne auch mehr bei grÃ¶ÃŸeren Ã„nderungen)
- **Pushen nur mit Freigabe vom User**, auÃŸer der Prompt am Anfang erlaubt direktes Pushen
- Bei mehreren Issues: Pro Issue eigene Commits erstellen, dann am Ende gesammelt pushen (nach Freigabe)

### Issues umsetzen

- **Issues IMMER komplett umsetzen** - nicht in Phasen oder Teilschritten
- Erst mit dem nÃ¤chsten Issue beginnen, wenn das aktuelle vollstÃ¤ndig abgeschlossen ist
- Bei Blockern oder Unklarheiten: User fragen, nicht teilweise implementieren

### CLAUDE.md Dateien

- **Automatisch generierte CLAUDE.md-Dateien regelmÃ¤ÃŸig mit committen**
- Diese Dateien werden vom Plugin automatisch aktualisiert
- User-Content auÃŸerhalb der generierten Bereiche bleibt erhalten

## Technische Details

### Monorepo-Struktur

```
packages/
â”œâ”€â”€ backend/     # Express API Server
â”œâ”€â”€ database/    # MikroORM Entities & Repositories
â”œâ”€â”€ hooks/       # Claude Code Hook Handlers
â”œâ”€â”€ shared/      # Shared Utilities (Logger, Settings)
â”œâ”€â”€ types/       # TypeScript Interfaces
â”œâ”€â”€ ui/          # React/Vite Frontend
â””â”€â”€ worker/      # AI Task Processing
plugin/          # Claude Code Plugin
```

### Wichtige Befehle

```bash
# Development
pnpm dev              # Build plugin + sync to marketplace
pnpm build            # Build all packages
pnpm test             # Run tests
pnpm typecheck        # TypeScript check (1x ausfÃ¼hren bis "Done", bei unklarer Ausgabe Script anpassen)
pnpm sync-marketplace # Sync plugin to Claude marketplace
pnpm dev:restart      # Restart dev services

# Einzelne Packages builden
pnpm build:backend    # Backend only
pnpm build:worker     # Worker only
pnpm build:hooks      # Hooks only
pnpm build:plugin     # Plugin only

# Docker
pnpm docker:up        # Start containers
pnpm docker:down      # Stop containers
pnpm docker:logs      # View logs
```

### Issue-Tracker

- Repository: `customable/claude-mem` auf Forgejo
- Labels werden automatisch gesetzt (priority, type)
- **Kommentare und Attachments in Issues IMMER prÃ¼fen** - kÃ¶nnen wichtige Informationen enthalten
- **Blocks und Dependencies beachten** - Issues kÃ¶nnen andere blockieren oder von anderen abhÃ¤ngen

### UI-Referenzen

- Screenshots und Design-Referenzen: `~/references`

### Bei grÃ¶ÃŸeren Ã„nderungen

Nach Ã„nderungen an Backend, Worker oder Hooks:

1. **Plugin builden und syncen:**
   ```bash
   pnpm build && pnpm sync-marketplace
   ```

2. **Backend-Erreichbarkeit prÃ¼fen:**
   - Nach Neustart testen ob Backend erreichbar ist
   - Falls nicht erreichbar: Erst stoppen, dann **ohne** `-head` oder `-tail` neustarten
   - Direkt die JS-Datei ausfÃ¼hren um vollstÃ¤ndigen Log zu sehen:
     ```bash
     node packages/backend/dist/cli.js start
     ```

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #3353 | 8:26 PM | ğŸ”µ | MikroORM database layer exports structure | ~1419 |
| #3352 | 8:26 PM | ğŸ”µ | [Compressed] Edit | ~127 |
| #3351 | 8:25 PM | ğŸ”µ | MikroORM Database Initializer Structure | ~1943 |
| #3350 | 8:25 PM | ğŸ”µ | [Compressed] Edit | ~106 |
| #3349 | 8:25 PM | ğŸ“ | Database layer documentation and structure overview | ~1396 |
| #3348 | 8:25 PM | ğŸ”µ | Database entities structure discovered | ~1574 |
| #3347 | 8:25 PM | ğŸ”µ | Building TypeScript types package | ~1118 |
| #3346 | 8:25 PM | ğŸ”µ | Exploring shared TypeScript types in claude-mem system | ~1544 |
| #3345 | 8:25 PM | ğŸ”µ | [Compressed] Read | ~151 |
| #3344 | 8:24 PM | ğŸ”„ | Separate type import for Ref in WorkerRegistration entity | ~1981 |
| #3343 | 8:24 PM | ğŸ”µ | WorkerRegistration Entity Structure | ~1647 |
| #3342 | 8:24 PM | ğŸ”µ | Backend service initialization process discovered | ~1693 |
| #3341 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~103 |
| #3340 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~108 |
| #3339 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~115 |
| #3338 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~105 |
| #3337 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~139 |
| #3336 | 8:23 PM | ğŸ”µ | [Compressed] Edit | ~108 |
| #3335 | 8:22 PM | ğŸŸ  | Add token-based authentication fields to ConnectedWorker interface | ~2237 |
| #3334 | 8:22 PM | ğŸ”µ | [Compressed] Edit | ~117 |
| #3333 | 8:22 PM | ğŸ”µ | [Compressed] Edit | ~122 |
| #3332 | 8:22 PM | ğŸ”µ | [Compressed] Edit | ~105 |
| #3331 | 8:22 PM | ğŸ”µ | WebSocket Types Structure | ~1449 |
| #3330 | 8:21 PM | ğŸ”µ | [Compressed] Read | ~101 |
| #3329 | 8:21 PM | ğŸ”µ | [Compressed] Read | ~151 |
| #3328 | 8:21 PM | ğŸ“‹ | Issue #316 now blocks issue #317 | ~1061 |
| #3327 | 8:21 PM | ğŸ”µ | [Compressed] Edit | ~130 |
| #3326 | 8:21 PM | ğŸ”µ | ğŸ”µ | [Compressed] Edit | ~152 |
| #3325 | 8:21 PM | ğŸ“‹ | PlanMode-Status auf Session tracken (EnterPlanMode/ExitPlanMode) | ~3634 |
| #3324 | 8:21 PM | ğŸ”µ | [Compressed] Edit | ~103 |

## Key Insights

- **Database Architecture**: MikroORM is used for multi-database support with Repository pattern abstractions. The database layer includes configuration, repositories, migrations, and entities.
- **TypeScript Refinements**: Type imports were separated for better build performance, and the TypeScript types package was built to ensure type definitions are up-to-date.
- **Authentication Enhancement**: Token-based authentication fields (`tokenId` and `systemId`) were added to the `ConnectedWorker` interface to support secure worker connections.
- **Dependency Management**: Issue #317 is now dependent on issue #316, establishing a clear priority in the project's issue tracking system.
- **PlanMode Tracking**: A new feature plan was created to track `PlanMode` status at the session level, addressing a gap in the current observation system.
</claude-mem-context>
