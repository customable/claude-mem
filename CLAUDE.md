# Claude-Mem Development Instructions

**WICHTIG: Alle Anweisungen in dieser Datei sind verbindlich und mÃ¼ssen strikt befolgt werden!**

## Workflow

### Commits & Push

- **Pro Issue mindestens ein Commit** (gerne auch mehr bei grÃ¶ÃŸeren Ã„nderungen)
- **Pushen nur mit Freigabe vom User**, auÃŸer der Prompt am Anfang erlaubt direktes Pushen
- Bei mehreren Issues: Pro Issue eigene Commits erstellen, dann am Ende gesammelt pushen (nach Freigabe)

### Issues umsetzen

- **Issues IMMER komplett umsetzen** - nicht in Phasen oder Teilschritten
- Erst mit dem nÃ¤chsten Issue beginnen, wenn das aktuelle vollstÃ¤ndig abgeschlossen ist
- Bei Blockern oder Unklarheiten: User fragen, nicht teilweise implementieren

### CLAUDE.md Dateien

- **Automatisch generierte CLAUDE.md-Dateien regelmÃ¤ÃŸig mit committen**
- Diese Dateien werden vom Plugin automatisch aktualisiert
- User-Content auÃŸerhalb der generierten Bereiche bleibt erhalten

## Technische Details

### Monorepo-Struktur

```
packages/
â”œâ”€â”€ backend/     # Express API Server
â”œâ”€â”€ database/    # MikroORM Entities & Repositories
â”œâ”€â”€ hooks/       # Claude Code Hook Handlers
â”œâ”€â”€ shared/      # Shared Utilities (Logger, Settings)
â”œâ”€â”€ types/       # TypeScript Interfaces
â”œâ”€â”€ ui/          # React/Vite Frontend
â””â”€â”€ worker/      # AI Task Processing
plugin/          # Claude Code Plugin
```

### Wichtige Befehle

```bash
# Development
pnpm dev              # Build plugin + sync to marketplace
pnpm build            # Build all packages
pnpm test             # Run tests
pnpm typecheck        # TypeScript check (1x ausfÃ¼hren bis "Done", bei unklarer Ausgabe Script anpassen)
pnpm sync-marketplace # Sync plugin to Claude marketplace
pnpm dev:restart      # Restart dev services

# Einzelne Packages builden
pnpm build:backend    # Backend only
pnpm build:worker     # Worker only
pnpm build:hooks      # Hooks only
pnpm build:plugin     # Plugin only

# Docker
pnpm docker:up        # Start containers
pnpm docker:down      # Stop containers
pnpm docker:logs      # View logs
```

### Issue-Tracker

- Repository: `customable/claude-mem` auf Forgejo
- Labels werden automatisch gesetzt (priority, type)
- **Kommentare und Attachments in Issues IMMER prÃ¼fen** - kÃ¶nnen wichtige Informationen enthalten
- **Blocks und Dependencies beachten** - Issues kÃ¶nnen andere blockieren oder von anderen abhÃ¤ngen

### UI-Referenzen

- Screenshots und Design-Referenzen: `~/references`

### Bei grÃ¶ÃŸeren Ã„nderungen

Nach Ã„nderungen an Backend, Worker oder Hooks:

1. **Plugin builden und syncen:**
   ```bash
   pnpm build && pnpm sync-marketplace
   ```

2. **Backend-Erreichbarkeit prÃ¼fen:**
   - Nach Neustart testen ob Backend erreichbar ist
   - Falls nicht erreichbar: Erst stoppen, dann **ohne** `-head` oder `-tail` neustarten
   - Direkt die JS-Datei ausfÃ¼hren um vollstÃ¤ndigen Log zu sehen:
     ```bash
     node packages/backend/dist/cli.js start
     ```

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #1935 | 4:47 PM | ðŸ”µ | Located ObservationTask interface | ~684 |
| #1934 | 4:47 PM | ðŸŸ  | Added observation fields: concept, gitBranch, decisionCategory | ~2835 |
| #1933 | 4:47 PM | ðŸŸ£ | Task 5 status updated to completed | ~707 |
| #1932 | 4:47 PM | ðŸ”µ | Task system architecture overview | ~3213 |
| #1931 | 4:47 PM | ðŸŸ  | Added fields to ObservationResult interface | ~2551 |
| #1930 | 4:47 PM | ðŸ”µ | Database model types for claude-mem | ~3322 |
| #1929 | 4:47 PM | ðŸŸ£ | Task 3 status updated to "in_progress" | ~699 |
| #1928 | 4:47 PM | ðŸŸ  | Added new fields to observation parsing | ~3707 |
| #1927 | 4:47 PM | ðŸŸ£ | Task 5 status updated to "in_progress" | ~695 |
| #1926 | 4:47 PM | ðŸŸ£ | Task 4 status updated to "in_progress" | ~723 |
| #1925 | 4:46 PM | ðŸ”„ | Expanded observation types in XML parser | ~3323 |
| #1924 | 4:46 PM | ðŸŸ£ | Task status updated from pending to in_progress | ~722 |
| #1923 | 4:46 PM | ðŸ”„ | Expanded ParsedObservation interface | ~2893 |
| #1922 | 4:46 PM | ðŸ”µ | Discovered system prompts for observation extraction | ~3708 |
| #1921 | 4:46 PM | ðŸŸ£ | Task 2 status updated to "in_progress" | ~699 |
| #1920 | 4:46 PM | ðŸŸ  | Update VALID_TYPES in xml-parser.ts | ~928 |
| #1919 | 4:45 PM | ðŸŸ  | Add new field parsing to xml-parser.ts | ~874 |
| #1918 | 4:45 PM | ðŸŸ  | Update ParsedObservation type | ~879 |
| #1917 | 4:45 PM | ðŸŸ£ | Run TypeScript check and fix errors | ~741 |
| #1916 | 4:45 PM | ðŸ”µ | Observation Entity Structure Analysis | ~1961 |
| #1915 | 4:45 PM | ðŸŸ  | Update OBSERVATION_SYSTEM_PROMPT | ~752 |
| #1914 | 4:45 PM | ðŸŸ  | Update observation-handler.ts | ~792 |
| #1913 | 4:45 PM | ðŸ”µ | Database model types for claude-mem | ~3302 |
| #1912 | 4:45 PM | ðŸ”µ | Agent Interface and Types Structure | ~1705 |
| #1911 | 4:45 PM | ðŸ”µ | Located ParsedObservation interface | ~694 |
| #1910 | 4:44 PM | ðŸ”µ | XML Parser for Agent Responses | ~2203 |
| #1909 | 4:44 PM | ðŸ”µ | Issue #290: Modularize UI Views | ~2299 |
| #1908 | 4:44 PM | ðŸ”µ | Observation Handler Structure | ~1937 |
| #1907 | 4:44 PM | ðŸ”µ | Discovered system prompts | ~3703 |
| #1906 | 4:44 PM | ðŸ”´ | Issue #292: OBSERVATION_SYSTEM_PROMPT out of sync | ~2328 |

## Key Insights

- **Observation System Enhancement**: Added new fields (`concept`, `gitBranch`, `decisionCategory`) to observation interfaces and parsing logic, expanding metadata capture capabilities.
- **Task System Progress**: Multiple tasks updated to "in_progress" and one completed, indicating active development workflow.
- **Critical Bug Identified**: OBSERVATION_SYSTEM_PROMPT is missing 9 observation types compared to the database definition, requiring synchronization.
- **UI Refactoring Needed**: Large UI files (e.g., Settings.tsx) identified for modularization to improve maintainability.
- **Type System Expansion**: Observation types expanded from 7 to 21 categories, improving observation classification granularity.
</claude-mem-context>
