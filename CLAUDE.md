# Claude-Mem Development Instructions

**WICHTIG: Alle Anweisungen in dieser Datei sind verbindlich und mÃ¼ssen strikt befolgt werden!**

## Workflow

### Commits & Push

- **Pro Issue mindestens ein Commit** (gerne auch mehr bei grÃ¶ÃŸeren Ã„nderungen)
- **Pushen nur mit Freigabe vom User**, auÃŸer der Prompt am Anfang erlaubt direktes Pushen
- Bei mehreren Issues: Pro Issue eigene Commits erstellen, dann am Ende gesammelt pushen (nach Freigabe)

### Issues umsetzen

- **Issues IMMER komplett umsetzen** - nicht in Phasen oder Teilschritten
- Erst mit dem nÃ¤chsten Issue beginnen, wenn das aktuelle vollstÃ¤ndig abgeschlossen ist
- Bei Blockern oder Unklarheiten: User fragen, nicht teilweise implementieren

### CLAUDE.md Dateien

- **Automatisch generierte CLAUDE.md-Dateien regelmÃ¤ÃŸig mit committen**
- Diese Dateien werden vom Plugin automatisch aktualisiert
- User-Content auÃŸerhalb der generierten Bereiche bleibt erhalten

## Technische Details

### Monorepo-Struktur

```
packages/
â”œâ”€â”€ backend/     # Express API Server
â”œâ”€â”€ database/    # MikroORM Entities & Repositories
â”œâ”€â”€ hooks/       # Claude Code Hook Handlers
â”œâ”€â”€ shared/      # Shared Utilities (Logger, Settings)
â”œâ”€â”€ types/       # TypeScript Interfaces
â”œâ”€â”€ ui/          # React/Vite Frontend
â””â”€â”€ worker/      # AI Task Processing
plugin/          # Claude Code Plugin
```

### Wichtige Befehle

```bash
# Development
pnpm dev              # Build plugin + sync to marketplace
pnpm build            # Build all packages
pnpm test             # Run tests
pnpm typecheck        # TypeScript check (1x ausfÃ¼hren bis "Done", bei unklarer Ausgabe Script anpassen)
pnpm sync-marketplace # Sync plugin to Claude marketplace
pnpm dev:restart      # Restart dev services

# Einzelne Packages builden
pnpm build:backend    # Backend only
pnpm build:worker     # Worker only
pnpm build:hooks      # Hooks only
pnpm build:plugin     # Plugin only

# Docker
pnpm docker:up        # Start containers
pnpm docker:down      # Stop containers
pnpm docker:logs      # View logs
```

### Issue-Tracker

- Repository: `customable/claude-mem` auf Forgejo
- Labels werden automatisch gesetzt (priority, type)
- **Kommentare und Attachments in Issues IMMER prÃ¼fen** - kÃ¶nnen wichtige Informationen enthalten
- **Blocks und Dependencies beachten** - Issues kÃ¶nnen andere blockieren oder von anderen abhÃ¤ngen

### UI-Referenzen

- Screenshots und Design-Referenzen: `~/references`

### Bei grÃ¶ÃŸeren Ã„nderungen

Nach Ã„nderungen an Backend, Worker oder Hooks:

1. **Plugin builden und syncen:**
   ```bash
   pnpm build && pnpm sync-marketplace
   ```

2. **Backend-Erreichbarkeit prÃ¼fen:**
   - Nach Neustart testen ob Backend erreichbar ist
   - Falls nicht erreichbar: Erst stoppen, dann **ohne** `-head` oder `-tail` neustarten
   - Direkt die JS-Datei ausfÃ¼hren um vollstÃ¤ndigen Log zu sehen:
     ```bash
     node packages/backend/dist/cli.js start
     ```

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 25, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2128 | 5:27 PM | ğŸ”µ | MikroORM Entity Relations Issue | ~3484 |
| #2127 | 5:27 PM | ğŸ”„ | Convert compressed_observation_id to ManyToOne | ~2288 |
| #2126 | 5:26 PM | ğŸ”µ | Database Compatibility for MikroORM | ~1636 |
| #2125 | 5:26 PM | ğŸ”µ | Located ArchivedOutputRepository | ~767 |
| #2124 | 5:26 PM | ğŸ”µ | TodoList & PlanMode Requirements | ~3566 |
| #2123 | 5:26 PM | ğŸ”µ | Claude Code Hook Structures Research | ~6049 |
| #2122 | 5:25 PM | ğŸŸ£ | Pushed UI Improvements to Feature Branch | ~1090 |
| #2121 | 5:25 PM | ğŸ”µ | Reviewed Open Issues | ~1277 |
| #2120 | 5:25 PM | ğŸŸ£ | Commit Auto-Generated CLAUDE.md | ~840 |
| #2119 | 5:25 PM | âœ… | Phase 4 Complete: User Experience | ~1578 |
| #2118 | 5:25 PM | ğŸ”µ | Endless Mode Feature in Settings | ~4696 |
| #2117 | 5:25 PM | ğŸ”µ | Multiple CLAUDE.md Files Modified | ~1414 |
| #2116 | 5:24 PM | ğŸ”µ | Endless Mode Feature Proposal | ~3282 |
| #2115 | 5:24 PM | ğŸ”µ | Search for "endless" in UI Files | ~901 |
| #2114 | 5:24 PM | ğŸŸ  | Add Endless Mode Dashboard Widget | ~1094 |
| #2113 | 5:22 PM | ğŸ”µ | Build Process with Chunk Warnings | ~1166 |
| #2112 | 5:22 PM | ğŸŸ  | Add Endless Mode Stats to Dashboard | ~5064 |
| #2111 | 5:22 PM | ğŸ”µ | TypeScript Type Check Passes | ~1032 |
| #2110 | 5:22 PM | ğŸŸ  | Added EndlessModeCard to Dashboard | ~6482 |
| #2109 | 5:21 PM | ğŸ”µ | API Client Interfaces Discovered | ~1451 |
| #2108 | 5:21 PM | ğŸ”µ | Dashboard UI Structure | ~1855 |
| #2107 | 5:21 PM | ğŸŸ  | Add endlessModeStatus to Dashboard | ~4355 |
| #2106 | 5:21 PM | ğŸŸ  | Add EndlessModeStatus Interface | ~4931 |
| #2105 | 5:21 PM | ğŸ”µ | Dashboard UI Components | ~2024 |
| #2104 | 5:20 PM | ğŸ”µ | Dashboard Uses SSE for Updates | ~1897 |
| #2103 | 5:20 PM | ğŸ”µ | Dashboard.tsx Size | ~1020 |
| #2102 | 5:20 PM | ğŸŸ  | Add Archived Outputs API Endpoints | ~6588 |
| #2101 | 5:20 PM | ğŸ”µ | Located Dashboard Component | ~702 |
| #2100 | 5:20 PM | ğŸ”µ | API Client Structure | ~1519 |
| #2099 | 5:20 PM | ğŸŸ  | Add Endless Mode Types | ~6161 |

## Key Insights

- **Endless Mode Feature**: A major feature for real-time context compression is being implemented, reducing token usage by ~95% and extending session limits. This includes a dual-memory system and dashboard widgets for tracking compression stats.
- **MikroORM Refactoring**: Critical issues with MikroORM entity relations (e.g., missing relations in `ArchivedOutput` and `Session` entities) are being addressed, along with database compatibility considerations for SQLite and PostgreSQL.
- **UI Improvements**: The `Settings.tsx` file was refactored into modular components, and new UI elements (e.g., `EndlessModeCard`) were added to the dashboard for better user experience.
- **Build Warnings**: The UI package has chunk size warnings (>500 kB), indicating potential optimization needs for CSS and bundle sizes.
- **Type Safety**: TypeScript checks passed across most packages, ensuring the codebase remains type-safe during development.
</claude-mem-context>
